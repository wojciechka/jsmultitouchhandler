function multiTouchHandler(e){this.type=e;this._uniqueId=0;this.touches=[];this.initialized=0;this.touchOnly=true;this.onChanged=function(){};this._events={start:[],move:[],end:[]};this.bind=function(e,t){if(e!="start"&&e!="move"&&e!="end"){throw'Invalid event "'+e+'"'}this.unbind(e,t);this._events[e][this._events[e].length]=t;return this};this.unbind=function(e,t){if(e!="start"&&e!="move"&&e!="end"){throw'Invalid event "'+e+'"'}oh=this._events[e];nh=[];for(var n=0;n<oh.length;n++){if(oh[n]!=t){nh[nh.length]=oh[n]}}this._events[n]=nh};this._call=function(e,t){hl=this._events[e];for(var n=0;n<hl.length;n++){try{hl[n](t)}catch(r){if(window.console)console.error("Error running multiTouchHandler event: "+r)}}};this._eventHandler=function(e,t,n,r,i){uid=-1;changed=0;if(t===0){uid=this._uniqueId++;to=new Object;to.x=n;to.y=r;to.internalId=e;to.id=uid;this.touches[this.touches.length]=to;changed=1;t="start"}else if(t===1){for(var s=0;s<this.touches.length;s++){if(this.touches[s].internalId===e){uid=this.touches[s].id;this.touches[s].x=n;changed=1;this.touches[s].y=r}}t="move"}else if(t===2){newTouches=[];for(var s=0;s<this.touches.length;s++){if(this.touches[s].internalId===e){uid=this.touches[s].id;changed=1}else{newTouches[newTouches.length]=this.touches[s]}}this.touches=newTouches;t="end"}if(changed){eventDetail=new Object;eventDetail.id=uid;eventDetail.type=t;this._call(t,eventDetail)}};this.initialize=function(){o=this;if(!o.initialized){document.addEventListener("touchstart",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t];o._eventHandler(n.identifier,0,n.clientX,n.clientY,e)}});document.addEventListener("touchmove",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t];o._eventHandler(n.identifier,1,n.clientX,n.clientY,e)}});document.addEventListener("touchend",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t];o._eventHandler(n.identifier,2,-1,-1,e)}});document.addEventListener("MSPointerDown",function(e){if(!o.touchOnly||e.pointerType==e.MSPOINTER_TYPE_TOUCH){o._eventHandler(e.pointerId,0,e.pageX,e.pageY,e)}});document.addEventListener("MSPointerMove",function(e){if(!o.touchOnly||e.pointerType==e.MSPOINTER_TYPE_TOUCH){o._eventHandler(e.pointerId,1,e.pageX,e.pageY,e)}});document.addEventListener("MSPointerUp",function(e){if(!o.touchOnly||e.pointerType==e.MSPOINTER_TYPE_TOUCH){o._eventHandler(e.pointerId,2,-1,-1,e)}})}}}